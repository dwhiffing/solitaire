{"version":3,"sources":["utils/index.js","components/Card.js","components/Header.js","App.js","index.js"],"names":["CARDS","split","map","n","value","Number","suit","flat","shuffleDeck","concat","chunk","shuffle","pile","pileIndex","i","cardPileIndex","c","index","isDescending","numbers","filter","number","length","moveCard","cards","movedCard","destinationCard","sourcePile","getCardPile","isFinished","numToMove","allowCheat","isCheat","isEmpty","movingCards","slice","validOrder","m","newCards","card","includes","isNaN","findIndex","finishedPiles","Object","values","groupBy","sort","a","b","join","getCardIsActive","activeCard","isActive","getBottomCard","decorateCard","getCanCardMove","bottom","useWindowEvent","event","callback","useEffect","window","addEventListener","removeEventListener","getCardFromPoint","x","y","elementUnder","document","elementFromPoint","parentElement","dataIndex","dataset","emptyCard","pileindex","getCardPosition","canMove","getCardSpacing","width","innerWidth","height","Math","min","max","innerHeight","yBuffer","SUITS","Card","onRest","mouseX","mouseY","xPos","yPos","shouldFollowCursor","yOffset","abs","spring","r","s","zIndex","classes","style","classNames","transform","DisplayCard","data-index","data-pileindex","className","Header","onReset","hasWon","winRef","useRef","timer","useState","Date","now","startTime","setStartTime","seconds","minutes","hours","time","setTime","interval","setInterval","difference","floor","reset","clearTimeout","clearInterval","useTimer","current","alert","textAlign","toString","padStart","onClick","confirm","initialState","startX","startY","App","setActiveCard","cursorState","setCursorState","setCards","setHasWon","uniq","debounce","setValue","useForceUpdate","e","diffX","pageX","diffY","pageY","passedThreshold","clickedCard","clientX","clientY","bottomCard","deltaY","deltaX","key","cardIndex","ReactDOM","render","getElementById"],"mappings":"mPAOMA,EAFS,YAEMC,MAAM,IACxBC,KAAI,SAAAC,GAAC,MAAI,CACR,CAAEC,MAAOC,OAAOF,GAAIG,KAAM,GAC1B,CAAEF,MAAOC,OAAOF,GAAIG,KAAM,GAC1B,CAAEF,MAAOC,OAAOF,GAAIG,KAAM,GAC1B,CAAEF,MAAOC,OAAOF,GAAIG,KAAM,OAE3BC,OAMUC,GAfE,YAWoBP,MAAM,IACtCC,KAAI,SAAAC,GAAC,MAAK,CAAEC,MAAOC,OAAOF,GAAIG,KAAM,MACpCG,OAbY,YAaER,MAAM,IAAIC,KAAI,SAAAC,GAAC,MAAK,CAAEC,MAAOC,OAAOF,GAAIG,KAAM,OAEpC,kBACzBI,IAAMC,IAAQX,GAAQ,GACnBE,KAAI,SAACU,EAAMC,GAAP,OACHD,EAAKV,KAAI,SAACC,EAAGW,GAAJ,sBACJX,EADI,CAEPY,cAAeD,EACfD,oBAGHN,OACAL,KAAI,SAACc,EAAGF,GAAJ,sBAAgBE,EAAhB,CAAmBC,MAAOH,SAEtBI,EAAe,SAAAC,GAC1B,OACEA,EAAQC,QAAO,SAACC,EAAQJ,GACtB,OAAOE,EAAQF,EAAQ,IAAKI,IAAWF,EAAQF,EAAQ,GAAK,KAC3DK,SAAWH,EAAQG,QAIbC,EAAW,SAACC,EAAOC,EAAWC,GACzC,IAAMC,EAAaC,EAAYH,EAAWD,GAC1C,GAAIC,EAAUI,aAAeH,GAAmBA,EAAgBG,WAC9D,OAAOL,EAGT,IAAMM,EAAYH,EAAWL,OAASG,EAAUV,cAC1CgB,EACU,IAAdD,IAAoBL,EAAUO,UAAYN,EAAgBM,QACtDA,EACJP,EAAUrB,QAAUsB,EAAgBtB,MAAQ,IAAMsB,EAAgBO,QAE9DC,EAAcP,EAAWQ,MAC7BV,EAAUV,cACVU,EAAUV,cAAgBe,GAGtBM,EACJV,EAAgBO,UACdP,EAAgBM,SAChBd,EAAa,CAACQ,EAAgBtB,OAAlB,mBAA4B8B,EAAYhC,KAAI,SAAAmC,GAAC,OAAIA,EAAEjC,YAE7DkC,EAAWd,EAAMtB,KAAI,SAAAqC,GACzB,GACEA,EAAK1B,YAAcY,EAAUZ,WAC7BY,EAAUZ,YAAca,EAAgBb,UAExC,OAAO0B,EAGT,IAAKL,EAAYhC,KAAI,SAAAc,GAAC,OAAIA,EAAEC,SAAOuB,SAASD,EAAKtB,OAC/C,OAAOsB,EAGT,IACGH,GAAcL,KACd1B,OAAOoC,MAAMf,EAAgBb,WAC9B,CACA,IAAME,EACJW,EAAgBX,cAChBmB,EAAYQ,WAAU,SAAA1B,GAAC,OAAIA,EAAEC,QAAUsB,EAAKtB,SAC5C,EAEF,OAAO,eACFsB,EADL,CAEE1B,UAAWa,EAAgBb,UAC3BE,gBACAiB,YAIJ,OAAOO,KAOHI,EAJQC,OAAOC,OACnBC,IAAQR,GAAU,SAAAC,GAAI,OAAIA,EAAK1B,cAC/BX,KAAI,SAAAU,GAAI,OAAIA,EAAKmC,MAAK,SAACC,EAAGC,GAAJ,OAAUD,EAAEjC,cAAgBkC,EAAElC,oBAGnDb,KAAI,SAAAU,GAAI,MAAK,CACZA,KAAMA,EAAKV,KAAI,SAAAqC,GAAI,OAAIA,EAAKnC,SAAO8C,KAAK,IACxCjC,MAAOL,EAAK,GAAGC,cAEhBO,QAAO,kBAAuB,cAAvB,EAAGR,QACVV,KAAI,SAAAU,GAAI,OAAIA,EAAKK,SAEpB,OAAOqB,EAASpC,KAAI,SAAAc,GAAC,sBAChBA,EADgB,CAEnBa,WAAYc,EAAcH,SAASxB,EAAEH,iBAIlC,SAASsC,EAAgBC,EAAYb,GAC1C,IAAIc,GAAW,EAQf,OANID,IACFC,EACED,EAAWvC,YAAc0B,EAAK1B,WAC9BuC,EAAWrC,eAAiBwB,EAAKxB,eAG9BsC,EAGF,IAAMzB,EAAc,SAACW,EAAMf,GAEhC,OADaA,EAAMJ,QAAO,SAAAJ,GAAC,OAAIA,EAAEH,YAAc0B,EAAK1B,aACxCkC,MAAK,SAACC,EAAGC,GAAJ,OAAUD,EAAEjC,cAAgBkC,EAAElC,kBAGpCuC,EAAgB,SAACf,EAAMf,GAClC,IAAKe,EACH,OAAO,KAGT,GAAIA,EAAKN,QACP,OAAOM,EAGT,IAAM3B,EAAOgB,EAAYW,EAAMf,GAE/B,OADAe,EAAO3B,EAAKA,EAAKU,OAAS,GACnBiC,EAAahB,EAAMf,IAGfgC,EAAiB,SAACjB,EAAMf,GACnC,IAAMZ,EAAOgB,EAAYW,EAAMf,GACzBiC,EAAS7C,EAAKV,KAAI,SAAAc,GAAC,OAAIA,EAAEZ,SAAO+B,MAAMI,EAAKxB,cAAeH,EAAKU,QACrE,OAAOJ,EAAauC,IAGTC,EAAiB,SAACC,EAAOC,GACpCC,qBAAU,WAER,OADAC,OAAOC,iBAAiBJ,EAAOC,GACxB,kBAAME,OAAOE,oBAAoBL,EAAOC,MAC9C,CAACD,EAAOC,KAGAK,EAAmB,SAACC,EAAGC,EAAG3C,GACrC,IAAIe,EACE6B,EAAeC,SAASC,iBAAiBJ,EAAGC,GAElD,GAAIC,GAAgBA,EAAaG,cAAe,CAC9C,IAAMC,EAAYJ,EAAaG,cAAcE,QAAQxD,MAErD,GAAIuD,EACFjC,EAAOf,GAAOgD,OACT,CACL,IAAIE,EAAY,CACd3D,eAAgB,EAChBF,WAAYuD,EAAaG,cAAcE,QAAQE,UAC/C1C,SAAS,GAIX,GAAoB,IAFPL,EAAY8C,EAAWlD,GAE3BF,OACP,OAAO,eAAKoD,EAAZ,GAA0BE,EAAgBF,KAKhD,OAAOnB,EAAahB,EAAMf,IAGtB+B,EAAe,SAAChB,EAAMf,GAAP,OACnBe,EAAI,eAEKA,EAFL,GAGKqC,EAAgBrC,GAHrB,CAIEsC,QAASrB,EAAejB,EAAMf,GAC9B6B,SAAUF,EAAgBZ,EAAMf,KAElC,MAkCOsD,EAAiB,WAC5B,IAAMC,EAAQjB,OAAOkB,WAAa,IAC9BC,EAASC,KAAKC,IAAI,GAAID,KAAKE,IAAItB,OAAOuB,YAAc,GAAI,KACxDC,EAAmB,EAATL,EAOd,OALInB,OAAOkB,WAAa,MAEtBM,EAAmB,GADnBL,EAASC,KAAKC,IAAI,GAAID,KAAKE,IAAItB,OAAOuB,YAAc,GAAI,OAInD,CAAEN,QAAOE,SAAQK,YAGbV,EAAkB,SAAArC,GAAS,IAAD,EACFuC,IAA3BC,EAD6B,EAC7BA,MAAOE,EADsB,EACtBA,OAAQK,EADc,EACdA,QAOvB,MAAO,CAAEpB,EALCa,EAAQ,EAAIxC,EAAK1B,UAAYkE,EAK3BZ,EAJF5B,EAAKN,QACXqD,EACAA,GAAW/C,EAAKV,WAAa,EAAIU,EAAKxB,cAAgBkE,K,OChPtDM,EAAQ,CAAC,SAAU,QAAS,SAAU,YAE/BC,EAAO,SAAC,GAMd,IALLjD,EAKI,EALJA,KACAa,EAII,EAJJA,WAII,IAHJqC,cAGI,MAHK,aAGL,MAFJC,cAEI,MAFK,EAEL,MADJC,cACI,MADK,EACL,EACIV,EAAWH,IAAXG,OADJ,EAEyBL,EAAgBrC,GAAlCqD,EAFP,EAEI1B,EAAY2B,EAFhB,EAEa1B,EAEX2B,EAAqBvD,EAAKc,UAAYd,EAAKsC,QAC3CkB,EAAUD,EACZb,EAASC,KAAKc,IAAI5C,EAAWrC,cAAgBwB,EAAKxB,eAClD,EAEEmD,EAAI4B,EAAqBJ,EAASO,iBAAOL,GACzCzB,EAAI2B,EAAqBH,EAASI,EAAUE,iBAAOJ,GACnDK,EAAID,iBAAO1D,EAAKP,QAAU,GAAK,GAC/BmE,EAAIF,iBAAO1D,EAAKc,SAAW,MAAQ,GACnC+C,EAASN,EACX,GAAKvD,EAAKxB,cACVwB,EAAKxB,cAEHsF,EAAU,CACd,OACA9D,EAAKV,WAAa,cAAlB,cAAyCU,EAAKnC,OAC9CmF,EAAMhD,EAAKjC,MACXiC,EAAKsC,SAAW,WAChBiB,GAAsB,gBACtBvD,EAAKN,SAAW,SAGlB,OACE,kBAAC,SAAD,CAAQqE,MAAO,CAAEpC,IAAGC,IAAG+B,IAAGC,KAAKV,OAAQA,IACpC,gBAAGvB,EAAH,EAAGA,EAAGC,EAAN,EAAMA,EAAG+B,EAAT,EAASA,EAAGC,EAAZ,EAAYA,EAAZ,OACC,kBAAC,EAAD,CACE5D,KAAMA,EACNgE,WAAYF,EACZC,MAAO,CACLE,UAAU,eAAD,OAAiBtC,EAAjB,eAAyBC,EAAzB,yBAA2C+B,EAA3C,sBAA0DC,EAA1D,KACTC,gBAQNK,EAAc,SAAC,GAA2C,IAAzClE,EAAwC,EAAxCA,KAAwC,IAAlCgE,kBAAkC,MAArB,GAAqB,MAAjBD,aAAiB,MAAT,GAAS,EACvDD,EAAO,CACX,QADW,mBAERE,GAFQ,CAGXhE,EAAKV,WAAa,cAAlB,cAAyCU,EAAKnC,OAC9CmF,EAAMhD,EAAKjC,QAGb,OACE,yBACEoG,aAAYnE,EAAKtB,MACjB0F,iBAAgBpE,EAAK1B,UACrB+F,UAAWP,EAAQnD,KAAK,KACxBoD,MAAOA,GAEP,yBAAKM,UAAU,SACdrE,EAAKV,YAAc,yBAAK+E,UAAU,W,2CCnElC,SAASC,EAAT,GAAsC,IAApBC,EAAmB,EAAnBA,QAASC,EAAU,EAAVA,OAC1BC,EAASC,kBAAO,GAChBC,EFiMgB,WAAO,IAAD,EACMC,mBAASC,KAAKC,OADpB,mBACrBC,EADqB,KACVC,EADU,OAEJJ,mBAAS,CAAEK,QAAS,EAAGC,QAAS,EAAGC,MAAO,IAFtC,mBAErBC,EAFqB,KAEfC,EAFe,KAwB5B,OApBA/D,qBAAU,WACR,IAAIgE,EAAWC,aAAY,WACzB,IAAMC,EAAaX,KAAKC,MAAQC,EAChCM,EAAQ,CACNF,MAAOxC,KAAK8C,MAAOD,EAAU,KAAuB,IACpDN,QAASvC,KAAK8C,MAAOD,EAAa,IAAO,GAAM,IAC/CP,QAAStC,KAAK8C,MAAOD,EAAa,IAAQ,IAC1CE,MAAO,WACLV,EAAaH,KAAKC,OAClBa,aAAaL,GACbD,EAAQ,CAAEJ,QAAS,EAAGC,QAAS,EAAGC,MAAO,SAG5C,KAEH,OAAO,WACLS,cAAcN,MAEf,CAACP,IAEGK,EEzNOS,GAcd,OAZAvE,qBAAU,WACJkD,IAAWC,EAAOqB,UACpBrB,EAAOqB,SAAU,EACjBC,MAAM,gCAAD,OAC6BpB,EAAMO,QADnC,qBACuDP,EAAMM,QAD7D,aAGLN,EAAMe,QACNnB,IACAE,EAAOqB,SAAU,KAElB,CAACtB,EAAQD,EAASI,IAGnB,oCACE,yBAAKZ,MAAO,CAAEvB,MAAO,KACnB,4CAGF,yBAAKuB,MAAO,CAAEvB,MAAO,GAAIwD,UAAW,WAClC,wCACMrB,EAAMO,QAAQe,WAAWC,SAAS,EAAG,KACvC,KAFJ,OAEUvB,EAAMM,QAAQgB,WAAWC,SAAS,EAAG,QAIjD,yBAAKnC,MAAO,CAAEvB,MAAO,GAAIwD,UAAW,WAClC,0BACEG,QAAS,WACK5E,OAAO6E,QAAQ,uBAEzB7B,IACAI,EAAMe,WALZ,OCfR,IAAMW,EAAe,CAAEC,OAAQ,EAAGC,OAAQ,EAAGnD,OAAQ,EAAGD,OAAQ,GA2GjDqD,MAzGf,WAAgB,IAAD,EACuB5B,mBAAS,MADhC,mBACN/D,EADM,KACM4F,EADN,OAEyB7B,mBAASyB,GAFlC,mBAENK,EAFM,KAEOC,EAFP,OAGa/B,mBAAS3G,KAHtB,mBAGNgB,EAHM,KAGC2H,EAHD,OAIehC,oBAAS,GAJxB,mBAINJ,EAJM,KAIEqC,EAJF,KAmEb,OA7DAvF,qBAAU,WACSwF,IAAK7H,EAAMJ,QAAO,SAAAJ,GAAC,OAAIA,EAAEa,cAAY3B,KAAI,SAAAc,GAAC,OAAIA,EAAEH,cACpDS,QAAU,IAAMyF,GAC3BqC,GAAU,KAEX,CAAC5H,EAAOuF,IAmDXrD,EAAe,SAAU4F,IH+GG,WAAO,IAAD,EACbnC,mBAAS,GAArBoC,EADyB,oBAElC,OAAO,kBAAMA,GAAS,SAAAnJ,GAAK,QAAMA,MGjHCoJ,GAAkB,MACpD9F,EAAe,aAlBG,SAAA+F,GAChB,IAAMC,EAAQxE,KAAKc,IAAIiD,EAAYJ,OAASY,EAAEE,OACxCC,EAAQ1E,KAAKc,IAAIiD,EAAYH,OAASW,EAAEI,OACxCC,EAAkBJ,EAAQ,IAAME,EAAQ,GAE9C,GAAIxG,EAAY,CACd,IAAI2G,EAAc9F,EAAiBwF,EAAEO,QAASP,EAAEQ,QAASzI,IACzDuI,EAAczG,EAAcyG,EAAavI,KAEvC2H,EAAS5H,EAASC,EAAO4B,EAAY2G,IAEnCD,GACFd,EAAc,UAOpBtF,EAAe,eAnDK,SAAA+F,GAAM,IACTZ,EAA0BY,EAAjCE,MAAsBb,EAAWW,EAAlBI,MAEnBtH,EAAO0B,EAAiBwF,EAAEO,QAASP,EAAEQ,QAASzI,GAClD,IAAKe,EACH,OAAOyG,EAAc,MAGvB,GAAI5F,EAAY,CACd,IAAM8G,EAAa5G,EAAcf,EAAMf,GACvC2H,EAAS5H,EAASC,EAAO4B,EAAY8G,IACrClB,EAAc,WACJzG,EAAKc,UAAYd,EAAKsC,SAChCmE,EAAczG,GAGhB,IAAMoD,EAASpD,EAAK4B,EACduB,EAASnD,EAAK2B,EACdiG,EAASrB,EAASvG,EAAK4B,EACvBiG,EAASvB,EAAStG,EAAK2B,EAC7BgF,EAAe,CAAExD,SAAQC,SAAQyE,SAAQD,SAAQtB,SAAQC,cAgC3DpF,EAAe,eA7BK,SAAC,GAAsB,IAApBmG,EAAmB,EAAnBA,MAAOF,EAAY,EAAZA,MACpBS,EAAmBnB,EAAnBmB,OAEFzE,EAASkE,EAFYZ,EAAXkB,OAGVzE,EAASiE,EAAQS,EAEvBlB,EAAe,eAAKD,EAAN,CAAmBtD,SAAQD,eA0BzC,yBAAKkB,UAAU,aACb,kBAACC,EAAD,CACEE,OAAQA,EACRD,QAAS,WACPqC,EAAS3I,KACT4I,GAAU,MAIb,CAAC,EAAG,EAAG,EAAG,EAAG,EAAG,GAAGlJ,KAAI,SAAAC,GAAC,OACvB,kBAAC,EAAD,CACEkK,IAAG,eAAUlK,GACboC,KAAM,CACJxB,eAAgB,EAChBF,UAAWV,EACX8B,SAAS,QAKdT,EAAMtB,KAAI,SAACqC,EAAM+H,GAAP,OACT,kBAAC,EAAD,CACED,IAAG,eAAUC,GACb/H,KAAI,eACCA,EADD,CAEFc,SAAUF,EAAgBC,EAAYb,GACtCsC,QAASrB,EAAejB,EAAMf,KAEhC4B,WAAYA,EACZsC,OAAQuD,EAAYvD,OACpBC,OAAQsD,EAAYtD,cCjH9B4E,IAASC,OAAO,kBAAC,EAAD,MAASnG,SAASoG,eAAe,U","file":"static/js/main.c5d39a40.chunk.js","sourcesContent":["import shuffle from 'lodash/shuffle'\nimport chunk from 'lodash/chunk'\nimport { useEffect, useState } from 'react'\nimport groupBy from 'lodash/groupBy'\n\nconst VALUES = '987654321'\n\nconst CARDS = VALUES.split('')\n  .map(n => [\n    { value: Number(n), suit: 0 },\n    { value: Number(n), suit: 1 },\n    { value: Number(n), suit: 2 },\n    { value: Number(n), suit: 3 },\n  ])\n  .flat()\n\nexport const SORTED_CARDS = VALUES.split('')\n  .map(n => ({ value: Number(n), suit: 0 }))\n  .concat(VALUES.split('').map(n => ({ value: Number(n), suit: 1 })))\n\nexport const shuffleDeck = () =>\n  chunk(shuffle(CARDS), 6)\n    .map((pile, pileIndex) =>\n      pile.map((n, i) => ({\n        ...n,\n        cardPileIndex: i,\n        pileIndex,\n      })),\n    )\n    .flat()\n    .map((c, i) => ({ ...c, index: i }))\n\nexport const isDescending = numbers => {\n  return (\n    numbers.filter((number, index) => {\n      return numbers[index + 1] ? number === numbers[index + 1] + 1 : true\n    }).length === numbers.length\n  )\n}\n\nexport const moveCard = (cards, movedCard, destinationCard) => {\n  const sourcePile = getCardPile(movedCard, cards)\n  if (movedCard.isFinished || !destinationCard || destinationCard.isFinished) {\n    return cards\n  }\n\n  const numToMove = sourcePile.length - movedCard.cardPileIndex\n  const allowCheat =\n    numToMove === 1 && !movedCard.isCheat && !destinationCard.isCheat\n  const isCheat =\n    movedCard.value !== destinationCard.value - 1 && !destinationCard.isEmpty\n\n  const movingCards = sourcePile.slice(\n    movedCard.cardPileIndex,\n    movedCard.cardPileIndex + numToMove,\n  )\n\n  const validOrder =\n    destinationCard.isEmpty ||\n    (!destinationCard.isCheat &&\n      isDescending([destinationCard.value, ...movingCards.map(m => m.value)]))\n\n  const newCards = cards.map(card => {\n    if (\n      card.pileIndex !== movedCard.pileIndex ||\n      movedCard.pileIndex === destinationCard.pileIndex\n    ) {\n      return card\n    }\n\n    if (!movingCards.map(c => c.index).includes(card.index)) {\n      return card\n    }\n\n    if (\n      (validOrder || allowCheat) &&\n      !Number.isNaN(destinationCard.pileIndex)\n    ) {\n      const cardPileIndex =\n        destinationCard.cardPileIndex +\n        movingCards.findIndex(c => c.index === card.index) +\n        1\n\n      return {\n        ...card,\n        pileIndex: destinationCard.pileIndex,\n        cardPileIndex,\n        isCheat,\n      }\n    }\n\n    return card\n  })\n\n  const piles = Object.values(\n    groupBy(newCards, card => card.pileIndex),\n  ).map(pile => pile.sort((a, b) => a.cardPileIndex - b.cardPileIndex))\n\n  const finishedPiles = piles\n    .map(pile => ({\n      pile: pile.map(card => card.value).join(''),\n      index: pile[0].pileIndex,\n    }))\n    .filter(({ pile }) => pile === '987654321')\n    .map(pile => pile.index)\n\n  return newCards.map(c => ({\n    ...c,\n    isFinished: finishedPiles.includes(c.pileIndex),\n  }))\n}\n\nexport function getCardIsActive(activeCard, card) {\n  let isActive = false\n\n  if (activeCard) {\n    isActive =\n      activeCard.pileIndex === card.pileIndex &&\n      activeCard.cardPileIndex <= card.cardPileIndex\n  }\n\n  return isActive\n}\n\nexport const getCardPile = (card, cards) => {\n  const pile = cards.filter(c => c.pileIndex === card.pileIndex)\n  return pile.sort((a, b) => a.cardPileIndex - b.cardPileIndex)\n}\n\nexport const getBottomCard = (card, cards) => {\n  if (!card) {\n    return null\n  }\n\n  if (card.isEmpty) {\n    return card\n  }\n\n  const pile = getCardPile(card, cards)\n  card = pile[pile.length - 1]\n  return decorateCard(card, cards)\n}\n\nexport const getCanCardMove = (card, cards) => {\n  const pile = getCardPile(card, cards)\n  const bottom = pile.map(c => c.value).slice(card.cardPileIndex, pile.length)\n  return isDescending(bottom)\n}\n\nexport const useWindowEvent = (event, callback) => {\n  useEffect(() => {\n    window.addEventListener(event, callback)\n    return () => window.removeEventListener(event, callback)\n  }, [event, callback])\n}\n\nexport const getCardFromPoint = (x, y, cards) => {\n  let card\n  const elementUnder = document.elementFromPoint(x, y)\n\n  if (elementUnder && elementUnder.parentElement) {\n    const dataIndex = elementUnder.parentElement.dataset.index\n\n    if (dataIndex) {\n      card = cards[+dataIndex]\n    } else {\n      let emptyCard = {\n        cardPileIndex: -1,\n        pileIndex: +elementUnder.parentElement.dataset.pileindex,\n        isEmpty: true,\n      }\n      const pile = getCardPile(emptyCard, cards)\n\n      if (pile.length === 0) {\n        return { ...emptyCard, ...getCardPosition(emptyCard) }\n      }\n    }\n  }\n\n  return decorateCard(card, cards)\n}\n\nconst decorateCard = (card, cards) =>\n  card\n    ? {\n        ...card,\n        ...getCardPosition(card),\n        canMove: getCanCardMove(card, cards),\n        isActive: getCardIsActive(card, cards),\n      }\n    : null\n\nexport const useForceUpdate = () => {\n  const [, setValue] = useState(0)\n  return () => setValue(value => ++value)\n}\n\nexport const useTimer = () => {\n  const [startTime, setStartTime] = useState(Date.now())\n  const [time, setTime] = useState({ seconds: 0, minutes: 0, hours: 0 })\n\n  useEffect(() => {\n    let interval = setInterval(() => {\n      const difference = Date.now() - startTime\n      setTime({\n        hours: Math.floor((difference / (1000 * 60 * 60)) % 24),\n        minutes: Math.floor((difference / 1000 / 60) % 60),\n        seconds: Math.floor((difference / 1000) % 60),\n        reset: () => {\n          setStartTime(Date.now())\n          clearTimeout(interval)\n          setTime({ seconds: 0, minutes: 0, hours: 0 })\n        },\n      })\n    }, 1000)\n\n    return () => {\n      clearInterval(interval)\n    }\n  }, [startTime])\n\n  return time\n}\n\nexport const getCardSpacing = () => {\n  const width = window.innerWidth / 6.2\n  let height = Math.min(38, Math.max(window.innerHeight / 16, 25))\n  let yBuffer = height * 2\n\n  if (window.innerWidth > 1000) {\n    height = Math.min(50, Math.max(window.innerHeight / 16, 25))\n    yBuffer = height * 3\n  }\n\n  return { width, height, yBuffer }\n}\n\nexport const getCardPosition = card => {\n  const { width, height, yBuffer } = getCardSpacing()\n\n  const x = width / 4 + card.pileIndex * width\n  const y = card.isEmpty\n    ? yBuffer\n    : yBuffer + (card.isFinished ? 0 : card.cardPileIndex * height)\n\n  return { x, y }\n}\n","import React from 'react'\nimport { Motion, spring } from 'react-motion'\nimport { getCardPosition, getCardSpacing } from '../utils'\nconst SUITS = ['spades', 'clubs', 'hearts', 'diamonds']\n\nexport const Card = ({\n  card,\n  activeCard,\n  onRest = () => {},\n  mouseX = 0,\n  mouseY = 0,\n}) => {\n  const { height } = getCardSpacing()\n  const { x: xPos, y: yPos } = getCardPosition(card)\n\n  const shouldFollowCursor = card.isActive && card.canMove\n  const yOffset = shouldFollowCursor\n    ? height * Math.abs(activeCard.cardPileIndex - card.cardPileIndex)\n    : 0\n\n  const x = shouldFollowCursor ? mouseX : spring(xPos)\n  const y = shouldFollowCursor ? mouseY + yOffset : spring(yPos)\n  const r = spring(card.isCheat ? 22 : 0)\n  const s = spring(card.isActive ? 1.185 : 1)\n  const zIndex = shouldFollowCursor\n    ? 35 + card.cardPileIndex\n    : card.cardPileIndex\n\n  const classes = [\n    'card',\n    card.isFinished ? 'is-finished' : `rank${card.value}`,\n    SUITS[card.suit],\n    card.canMove && 'can-move',\n    shouldFollowCursor && 'disable-touch',\n    card.isEmpty && 'empty',\n  ]\n\n  return (\n    <Motion style={{ x, y, r, s }} onRest={onRest}>\n      {({ x, y, r, s }) => (\n        <DisplayCard\n          card={card}\n          classNames={classes}\n          style={{\n            transform: `translate3d(${x}px, ${y}px, 0) rotate(${r}deg) scale(${s})`,\n            zIndex,\n          }}\n        />\n      )}\n    </Motion>\n  )\n}\n\nconst DisplayCard = ({ card, classNames = [], style = {} }) => {\n  const classes = [\n    'card',\n    ...classNames,\n    card.isFinished ? 'is-finished' : `rank${card.value}`,\n    SUITS[card.suit],\n  ]\n\n  return (\n    <div\n      data-index={card.index}\n      data-pileindex={card.pileIndex}\n      className={classes.join(' ')}\n      style={style}\n    >\n      <div className=\"face\" />\n      {card.isFinished && <div className=\"back\" />}\n    </div>\n  )\n}\n","import React, { useEffect, useRef } from 'react'\nimport { useTimer } from '../utils'\nexport function Header({ onReset, hasWon }) {\n  const winRef = useRef(false)\n  const timer = useTimer()\n\n  useEffect(() => {\n    if (hasWon && !winRef.current) {\n      winRef.current = true\n      alert(\n        `You win! Your final time was ${timer.minutes} minutes, ${timer.seconds} seconds`,\n      )\n      timer.reset()\n      onReset()\n      winRef.current = false\n    }\n  }, [hasWon, onReset, timer])\n\n  return (\n    <>\n      <div style={{ width: 80 }}>\n        <span>Solitaire</span>\n      </div>\n\n      <div style={{ width: 80, textAlign: 'center' }}>\n        <span>\n          {`${timer.minutes.toString().padStart(2, '0') +\n            ':'}${timer.seconds.toString().padStart(2, '0')}`}\n        </span>\n      </div>\n\n      <div style={{ width: 80, textAlign: 'center' }}>\n        <span\n          onClick={() => {\n            const yes = window.confirm('Start a new game?')\n            if (yes) {\n              onReset()\n              timer.reset()\n            }\n          }}\n        >\n          +\n        </span>\n      </div>\n    </>\n  )\n}\n","import React, { useState, useEffect } from 'react'\nimport {\n  shuffleDeck,\n  useWindowEvent,\n  moveCard,\n  getCanCardMove,\n  getCardIsActive,\n  getCardFromPoint,\n  useForceUpdate,\n  getBottomCard,\n} from './utils'\nimport { Card } from './components/Card'\nimport './index.css'\nimport debounce from 'lodash/debounce'\nimport uniq from 'lodash/uniq'\nimport { Header } from './components/Header'\n\nconst initialState = { startX: 0, startY: 0, mouseY: 0, mouseX: 0 }\n\nfunction App() {\n  const [activeCard, setActiveCard] = useState(null)\n  const [cursorState, setCursorState] = useState(initialState)\n  const [cards, setCards] = useState(shuffleDeck())\n  const [hasWon, setHasWon] = useState(false)\n\n  useEffect(() => {\n    const finished = uniq(cards.filter(c => c.isFinished).map(c => c.pileIndex))\n    if (finished.length >= 4 && !hasWon) {\n      setHasWon(true)\n    }\n  }, [cards, hasWon])\n\n  const onMouseDown = e => {\n    const { pageX: startX, pageY: startY } = e\n\n    let card = getCardFromPoint(e.clientX, e.clientY, cards)\n    if (!card) {\n      return setActiveCard(null)\n    }\n\n    if (activeCard) {\n      const bottomCard = getBottomCard(card, cards)\n      setCards(moveCard(cards, activeCard, bottomCard))\n      setActiveCard(null)\n    } else if (!card.isActive && card.canMove) {\n      setActiveCard(card)\n    }\n\n    const mouseY = card.y\n    const mouseX = card.x\n    const deltaY = startY - card.y\n    const deltaX = startX - card.x\n    setCursorState({ mouseX, mouseY, deltaX, deltaY, startX, startY })\n  }\n\n  const onMouseMove = ({ pageY, pageX }) => {\n    const { deltaX, deltaY } = cursorState\n\n    const mouseY = pageY - deltaY\n    const mouseX = pageX - deltaX\n\n    setCursorState({ ...cursorState, mouseY, mouseX })\n  }\n\n  const onMouseUp = e => {\n    const diffX = Math.abs(cursorState.startX - e.pageX)\n    const diffY = Math.abs(cursorState.startY - e.pageY)\n    const passedThreshold = diffX > 20 || diffY > 20\n\n    if (activeCard) {\n      let clickedCard = getCardFromPoint(e.clientX, e.clientY, cards, true)\n      clickedCard = getBottomCard(clickedCard, cards)\n      if (clickedCard) {\n        setCards(moveCard(cards, activeCard, clickedCard))\n      }\n      if (passedThreshold) {\n        setActiveCard(null)\n      }\n    }\n  }\n\n  useWindowEvent('resize', debounce(useForceUpdate(), 500))\n  useWindowEvent('pointerup', onMouseUp)\n  useWindowEvent('pointerdown', onMouseDown)\n  useWindowEvent('pointermove', onMouseMove)\n\n  return (\n    <div className=\"container\">\n      <Header\n        hasWon={hasWon}\n        onReset={() => {\n          setCards(shuffleDeck())\n          setHasWon(false)\n        }}\n      />\n\n      {[0, 1, 2, 3, 4, 5].map(n => (\n        <Card\n          key={`pile-${n}`}\n          card={{\n            cardPileIndex: -1,\n            pileIndex: n,\n            isEmpty: true,\n          }}\n        />\n      ))}\n\n      {cards.map((card, cardIndex) => (\n        <Card\n          key={`card-${cardIndex}`}\n          card={{\n            ...card,\n            isActive: getCardIsActive(activeCard, card),\n            canMove: getCanCardMove(card, cards),\n          }}\n          activeCard={activeCard}\n          mouseX={cursorState.mouseX}\n          mouseY={cursorState.mouseY}\n        />\n      ))}\n    </div>\n  )\n}\n\nexport default App\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\n\nReactDOM.render(<App />, document.getElementById('root'))\n"],"sourceRoot":""}